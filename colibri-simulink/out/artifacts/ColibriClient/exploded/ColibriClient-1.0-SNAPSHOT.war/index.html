<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Matlab-Simulink Connector</title>
    <link href="bootstrap.min.css" rel="stylesheet">
    <style>
        .jumbotron {
            background-color: #F9B10A;
            width: 100%;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .switch input {
            display: none;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            -webkit-transition: .4s;
            transition: .4s;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            -webkit-transition: .4s;
            transition: .4s;
        }

        input:checked + .slider {
            background-color: #2196F3;
        }

        input:focus + .slider {
            box-shadow: 0 0 1px #2196F3;
        }

        input:checked + .slider:before {
            -webkit-transform: translateX(26px);
            -ms-transform: translateX(26px);
            transform: translateX(26px);
        }
        /* Rounded sliders */

        .slider.round {
            border-radius: 34px;
        }

        .slider.round:before {
            border-radius: 50%;
        }
        /*	On Off Switch	*/

        .onoffswitch {
            position: relative;
            width: 90px;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        .onoffswitch-checkbox {
            display: none;
        }

        .onoffswitch-label {
            display: block;
            overflow: hidden;
            cursor: pointer;
            border: 2px solid #999999;
            border-radius: 20px;
        }

        .onoffswitch-inner {
            display: block;
            width: 200%;
            margin-left: -100%;
            transition: margin 0.3s ease-in 0s;
        }

        .onoffswitch-inner:before,
        .onoffswitch-inner:after {
            display: block;
            float: left;
            width: 50%;
            height: 30px;
            padding: 0;
            line-height: 30px;
            font-size: 14px;
            color: white;
            font-family: Trebuchet, Arial, sans-serif;
            font-weight: bold;
            box-sizing: border-box;
        }

        .onoffswitch-inner:before {
            content: "ON";
            padding-left: 10px;
            background-color: #34A7C1;
            color: #FFFFFF;
        }

        .onoffswitch-inner:after {
            content: "OFF";
            padding-right: 10px;
            background-color: #EEEEEE;
            color: #999999;
            text-align: right;
        }

        .onoffswitch-switch {
            display: block;
            width: 18px;
            margin: 6px;
            background: #FFFFFF;
            position: absolute;
            top: 0;
            bottom: 0;
            right: 56px;
            border: 2px solid #999999;
            border-radius: 20px;
            transition: all 0.3s ease-in 0s;
        }

        .onoffswitch-checkbox:checked + .onoffswitch-label .onoffswitch-inner {
            margin-left: 0;
        }

        .onoffswitch-checkbox:checked + .onoffswitch-label .onoffswitch-switch {
            right: 0px;
        }
    </style>

</head>

<body>
<script type="text/javascript">

    var webSocket;


    function openSocket(){
        // Ensures only one connection is open at a time
        if(webSocket !== undefined && webSocket.readyState !== WebSocket.CLOSED){
            writeResponse("WebSocket is already opened.");
            return;
        }
        // Create a new instance of the websocket
        webSocket = new WebSocket("ws://localhost:8080/ColibriClient-1.0-SNAPSHOT/echo");

        /**
         * Binds functions to the listeners for the websocket.
         */
        webSocket.onopen = function(event){
            // For reasons I can't determine, onopen gets called twice
            // and the first time event.data is undefined.
            // Leave a comment if you know the answer.
            if(event.data === undefined)
                return;

            writeResponse(event.data);
        };

        webSocket.onmessage = function(event){
            writeResponse(event.data);
        };

        webSocket.onclose = function(event){
            writeResponse("Connection closed");
        };
    }

    /**
     * Sends the value of the text input to the server
     */
    function send(text){
        webSocket.send(text);
    }

    function closeSocket(){
        webSocket.close();
    }

    function writeResponse(text){
        if (text == "Connection Established" || text == "Connection closed")
            document.getElementById("messages").innerHTML = text;
        else if (text == "2.0" || text == "3.0")
            response(text);
        else
            document.getElementById("ele1").value = text;
    }

</script>
<div class="jumbotron text-center">
    <h1>MATLAB Simulink Connector</h1>
</div>
<!--end of jumbotron-->


<div class="container">
    Open/Close the connection:<hr><label class="switch">
    <input type="checkbox" id="swtch1" onclick="change()">
    <div class="slider round"></div>
</label>
    <div id = "messages"></div>
    <hr>
    <div class="row">
        <div class="col-lg-6 text-center" >
            <br><br><br>

            <div class="form-group">
                <label for="ele1">Temperature</label>
                <input type="text" id="ele1" class="form-control">
            </div>
            <button type="button" class="btn btn-success btn-lg" onclick="temp()">Get</button>

        </div>
        <div class="col-lg-6 text-center" style="padding-top:20px;border-left:1px solid lightgray">
            <img id="myImage" src="lightoff.png" width="100" height="180">
            <p></p>
            <label class="switch">
                <input type="checkbox" id="swtch" onclick="changeImage()">
                <div class="slider round"></div>
            </label>
        </div>
    </div>
</div>



<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<script src="http://code.jquery.com/jquery-2.1.1.min.js"></script>
<script src="bootstrap.min.js"></script>
<script>
    function changeImage() {

        if (document.getElementById('swtch').checked) {

            send("on");
        } else {
            send("off");
        }
    }
    $(document).ready(function () {
        $('.day-night').click(function () {
            $('body').toggleClass('night');
        });
    });
</script>
<script>
    function change() {
        if (document.getElementById('swtch1').checked) {
            openSocket();
        } else {
            closeSocket();
        }
    }
</script>
<script>
    function response(text) {
        var image = document.getElementById('myImage');
        if (text == "2.0") {
            image.src = "lighton.png";
        } else {
            image.src = "lightoff.png";
        }
    }
</script>
<script>
    function temp() {
        send("get");
    }
</script>
</body>

</html>